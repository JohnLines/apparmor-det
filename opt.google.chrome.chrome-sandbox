# Last Modified: Tue Sep 25 14:54:59 2012
#include <tunables/global>

/opt/google/chrome/chrome-sandbox {
  capability chown,
##  capability dac_override,
  capability fsetid,
  capability setgid,
  capability setuid,
  capability sys_admin,
  capability sys_chroot,
  capability sys_ptrace,

  /etc/ld.so.cache r,
  /lib/@{multiarch}/ld-*.so* mr,
  /lib/x86_64-linux-gnu/libattr.so* mr,
  /lib/x86_64-linux-gnu/libc-*.so mr,
  /lib/x86_64-linux-gnu/libcap.so* mr,
  /lib/x86_64-linux-gnu/libexpat.so* mr,
  /lib/x86_64-linux-gnu/librt-*.so mr,
  /lib/x86_64-linux-gnu/libdl-*.so mr,
  /lib/x86_64-linux-gnu/libglib-*.so* mr,
  /lib/x86_64-linux-gnu/libgcc_s.so* mr,
  /lib/x86_64-linux-gnu/libm-*.so mr,
  /lib/x86_64-linux-gnu/libpcre.so* mr,
  /lib/x86_64-linux-gnu/libpng*.so* mr,
  /lib/x86_64-linux-gnu/libpthread-*.so mr,
  /lib/x86_64-linux-gnu/libz.so* mr,
  /usr/lib/x86_64-linux-gnu/libcairo.so* mr,
  /usr/lib/x86_64-linux-gnu/libfontconfig.so* mr,
  /usr/lib/x86_64-linux-gnu/libfreetype.so* mr,
  /usr/lib/x86_64-linux-gnu/libpixman-*.so* mr,
  /usr/lib/x86_64-linux-gnu/libnss3.so mr,
  /usr/lib/x86_64-linux-gnu/nss/*.so mr,
  /usr/lib/x86_64-linux-gnu/libnssutil3.so mr,
  /usr/lib/x86_64-linux-gnu/libnspr4.so mr,
  /usr/lib/x86_64-linux-gnu/libplc4.so* mr,
  /usr/lib/x86_64-linux-gnu/libplds*.so* mr,
  /usr/lib/x86_64-linux-gnu/libsqlite3.so* mr,
  /usr/lib/x86_64-linux-gnu/libstdc++.so* mr,
  /usr/lib/x86_64-linux-gnu/libxcb.so* mr,
  /usr/lib/x86_64-linux-gnu/libxcb-render.so* mr,
  /usr/lib/x86_64-linux-gnu/libxcb-shm.so* mr,
  /usr/lib/x86_64-linux-gnu/libXau.so* mr,
  /usr/lib/x86_64-linux-gnu/libXdmcp.so* mr,
  /usr/lib/x86_64-linux-gnu/libXrender.so* mr,
  /usr/lib/x86_64-linux-gnu/libXext.so* mr,
  /usr/lib/x86_64-linux-gnu/libX11.so* mr,

  /dev/urandom r,

  /sys/devices/system/cpu/online r,
  /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_max_freq r,

  /proc/ r,
  /proc/*/fd/ r,
  /proc/cpuinfo r,
  /proc/stat r,
  owner /tmp/** rw,
  @{PROC}/ r,
  @{PROC}/[0-9]*/ r,
  @{PROC}/[0-9]*/fd/ r,
  @{PROC}/[0-9]*/oom_adj w,
  @{PROC}/[0-9]*/oom_score_adj w,
  @{PROC}/[0-9]*/task/ r,
  @{PROC}/[0-9]*/task/[0-9]*/stat r,

  # Transition to main chrome binary
  /opt/google/chrome/chrome rPx,
  /opt/google/chrome/chrome-sandbox r,
  /opt/google/chrome/nacl_helper rix,

}